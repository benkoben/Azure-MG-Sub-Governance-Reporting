{
  "displayName": "[Preview]: Control the use of Storage Accounts in a Virtual Enclave",
  "policyType": "BuiltIn",
  "description": "This initiative deploys Azure policies for Storage Accounts ensuring boundary protection of this resource while it operates within the logically separated structure of Azure Virtual Enclaves. https://aka.ms/VirtualEnclaves",
  "metadata": {
    "version": "1.1.0-preview",
    "category": "VirtualEnclaves",
    "preview": true
  },
  "policyDefinitions": [
    {
      "policyDefinitionReferenceId": "StorageAccountShouldUseCmkForEncryption",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldRestrictPublicAccess",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7809fda1-ba27-48c1-9c63-1f5aee46ba89"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldHaveRestrictedPublicAccess",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/41a72361-06e3-4e80-832a-690bd0708bc1"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldUseHttpsTrafficOnly",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldUseTls12",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
      "parameters": {
        "minimumTlsVersion": {
          "value": "TLS1_2"
        }
      }
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldDisablePublicBlobAccess",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldUseCmkForEncryptionScopes",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b5ec538c-daa0-4006-8596-35468b9148e8"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldUseCmkForTableEncryption",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7c322315-e26d-4174-a99e-f49d351b4688"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldUseCmkForQueueEncryption",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e5abd0-2554-4736-b7c0-4ffef23475ef"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldUsePrivateLink",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6edd7eda-6dd8-40f7-810d-67160c639cd9"
    },
    {
      "policyDefinitionReferenceId": "StorageAccountShouldHaveDefenderEnabled",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/640d2586-54d2-465f-877f-9ffc1d2109f4"
    }
  ]
}
