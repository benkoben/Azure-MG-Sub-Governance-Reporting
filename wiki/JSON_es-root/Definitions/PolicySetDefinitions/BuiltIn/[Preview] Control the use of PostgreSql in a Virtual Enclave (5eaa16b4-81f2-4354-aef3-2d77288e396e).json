{
  "displayName": "[Preview]: Control the use of PostgreSql in a Virtual Enclave",
  "policyType": "BuiltIn",
  "description": "This initiative deploys Azure policies for PostgreSql ensuring boundary protection of this resource while it operates within the logically separated structure of Azure Virtual Enclaves. https://aka.ms/VirtualEnclaves",
  "metadata": {
    "version": "1.0.0-preview",
    "category": "VirtualEnclaves",
    "preview": true
  },
  "policyDefinitions": [
    {
      "policyDefinitionReferenceId": "PostgreSQLServersShouldHaveTransparentDataEncryptionEnabled",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d158790f-bfb0-486c-8631-2dc6b4e8e6af"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLShouldDisablePublicNetworkAccess",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLShouldEnabledLogDuration",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e8f3"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLShouldEnabledLogCheckpoint",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e43d"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLShouldEnabledLogConnections",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e442"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLShouldEnabledConnectionThrottling",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5345bb39-67dc-4960-a1bf-427e16b9a0bd"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLShouldEnabledDisconnections",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e446"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLShouldCustomerManagedKeysEncryptDataAtRest",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLShouldEnabledInfrastructureEncryption",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/24fba194-95d6-48c0-aea7-f65bf859c598"
    },
    {
      "policyDefinitionReferenceId": "PostgreSQLEnabledConfigureAdvancedThreatProtection",
      "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3"
    }
  ]
}
