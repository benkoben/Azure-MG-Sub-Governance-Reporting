{
  "Tenant": {
    "TenantId": "aa75eff7-49f7-4da2-a046-a86d8da21c56",
    "RoleAssignments": {
      "/providers/microsoft.authorization/roleassignments/5165cf4a-c0a5-4763-9a30-476381a3b80e": [
        {
          "RoleAssignmentId": "/providers/microsoft.authorization/roleassignments/5165cf4a-c0a5-4763-9a30-476381a3b80e",
          "Scope": "/",
          "DisplayName": "Ben Kooijman",
          "SignInName": "ben_kooijman.se#EXT#@benkooijman.onmicrosoft.com",
          "RoleDefinitionName": "User Access Administrator",
          "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
          "ObjectId": "5df7c533-ca40-429d-8f90-16357c4b564b",
          "ObjectType": "User",
          "PIM": "false"
        }
      ]
    },
    "ManagementGroups": {
      "es-root": {
        "MgId": "es-root",
        "MgName": "es",
        "mgParentId": "aa75eff7-49f7-4da2-a046-a86d8da21c56",
        "mgParentName": "Tenant Root Group",
        "level": "1",
        "PolicyDefinitionsCustom": {
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforappconfiguration": {
            "properties": {
              "displayName": "Deploy DNS for App Configuration",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.8014839Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1678692Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.AppConfiguration/configurationStores"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "configurationStores"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "AppConfiguration-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAppConfiguration",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForAppConfiguration",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7561606Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforautomationdscandhybridworker": {
            "properties": {
              "displayName": "Deploy DNS for Automation DSCAndHybridWorker",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.6935826Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1317861Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Automation/automationAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "DSCAndHybridWorker"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "AutomationDSCAndHybridWorker-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAutomationDSCAndHybridWorker",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForAutomationDSCAndHybridWorker",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6624081Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforautomationwebhook": {
            "properties": {
              "displayName": "Deploy DNS for Automation Webhook",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7007172Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1466304Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Automation/automationAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "Webhook"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "AutomationWebhook-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAutomationWebhook",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForAutomationWebhook",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6624081Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforazurefilesync": {
            "properties": {
              "displayName": "Deploy DNS for Azure File Sync",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.724135Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1449727Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.StorageSync/storageSyncServices"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "afs"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "AzureFileSync-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAzureFileSync",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForAzureFileSync",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforazuresearch": {
            "properties": {
              "displayName": "Deploy DNS for Azure Search",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.6772087Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1328517Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Search/searchServices"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "searchService"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "AzureSearch-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAzureSearch",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForAzureSearch",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6467827Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcacheforredis": {
            "properties": {
              "displayName": "Deploy DNS for Cache for Redis",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7087582Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1308208Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Cache/Redis"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "redisCache"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "CacheforRedis-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCacheforRedis",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForCacheforRedis",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcacheforredisenterprise": {
            "properties": {
              "displayName": "Deploy DNS for Cache for Redis Enterprise",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7596624Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1413982Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Cache/redisEnterprise"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "redisCache"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "CacheforRedisEnterprise-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCacheforRedisEnterprise",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForCacheforRedisEnterprise",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7092847Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcognitiveservices": {
            "properties": {
              "displayName": "Deploy DNS for Cognitive Services",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.810846Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1134497Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.CognitiveServices/accounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "account"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "CognitiveServices-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCognitiveServices",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForCognitiveServices",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7405341Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcontainerregistry": {
            "properties": {
              "displayName": "Deploy DNS for Container Registry",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.6788303Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.16626Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.ContainerRegistry/registries"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "registry"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "ContainerRegistry-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForContainerRegistry",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForContainerRegistry",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6467827Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcosmoscassandra": {
            "properties": {
              "displayName": "Deploy DNS for Cosmos Cassandra",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7212817Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1632234Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DocumentDB/databaseAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "Cassandra"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "CosmosCassandra-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosCassandra",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForCosmosCassandra",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.1300033Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcosmosgremlin": {
            "properties": {
              "displayName": "Deploy DNS for Cosmos Gremlin",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.8437264Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1429276Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DocumentDB/databaseAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "Gremlin"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "CosmosGremlin-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosGremlin",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForCosmosGremlin",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7561606Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcosmosmongodb": {
            "properties": {
              "displayName": "Deploy DNS for Cosmos MongoDB",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7055251Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1287671Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DocumentDB/databaseAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "MongoDB"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "CosmosMongoDB-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosMongoDB",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForCosmosMongoDB",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcosmossql": {
            "properties": {
              "displayName": "Deploy DNS for Cosmos Sql",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.8179607Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1201881Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DocumentDB/databaseAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "sql"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "CosmosSql-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosSql",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForCosmosSql",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7717886Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforcosmostable": {
            "properties": {
              "displayName": "Deploy DNS for Cosmos Table",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7742277Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1174859Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DocumentDB/databaseAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "Table"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "CosmosTable-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosTable",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForCosmosTable",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7249119Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsfordatafactory": {
            "properties": {
              "displayName": "Deploy DNS for Data Factory",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7213626Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1217528Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DataFactory/factories"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "dataFactory"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "DataFactory-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataFactory",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForDataFactory",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6936592Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsfordatalakefilesystem": {
            "properties": {
              "displayName": "Deploy DNS for Data Lake File System",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7592431Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1228728Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "dfs"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "DataLakeFileSystem-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataLakeFileSystem",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForDataLakeFileSystem",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6936592Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsfordatalakefilesystemsecondary": {
            "properties": {
              "displayName": "Deploy DNS for Data Lake File System Secondary",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7982588Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1635944Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "dfs_secondary"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "DataLakeFileSystemSecondary-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataLakeFileSystemSecondary",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForDataLakeFileSystemSecondary",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7561606Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsfordigitaltwins": {
            "properties": {
              "displayName": "Deploy DNS for Digital Twins",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.8253518Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1411363Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DigitalTwins/digitalTwinsInstances"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "digitalTwinsInstances"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "DigitalTwins-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDigitalTwins",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForDigitalTwins",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7561606Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforeventgriddomain": {
            "properties": {
              "displayName": "Deploy DNS for Event Grid Domain",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7754503Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.116537Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.EventGrid/domains"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "domain"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "EventGridDomain-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventGridDomain",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForEventGridDomain",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7405341Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforeventgridtopic": {
            "properties": {
              "displayName": "Deploy DNS for Event Grid Topic",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7714212Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1563698Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.EventGrid/topics"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "topic"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "EventGridTopic-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventGridTopic",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForEventGridTopic",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6936592Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforeventhubs": {
            "properties": {
              "displayName": "Deploy DNS for Event Hubs",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7914165Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1258074Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.EventHub/namespaces"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "namespace"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "EventHubs-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventHubs",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForEventHubs",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7249119Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforhdinsights": {
            "properties": {
              "displayName": "Deploy DNS for HDInsights",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.6920193Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1600113Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.HDInsight/clusters"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "cluster"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "HDInsights-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForHDInsights",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForHDInsights",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6624081Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforkeyvault": {
            "properties": {
              "displayName": "Deploy DNS for Key Vault",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7314107Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1183487Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.KeyVault/vaults"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "vault"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "KeyVault-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForKeyVault",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForKeyVault",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6936592Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsformariadb": {
            "properties": {
              "displayName": "Deploy DNS for MariaDB",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7977498Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1055559Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DBforMariaDB/servers"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "mariadbServer"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "MariaDB-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForMariaDB",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForMariaDB",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7249119Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsformysql": {
            "properties": {
              "displayName": "Deploy DNS for MySQL",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.8335653Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1406095Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DBforMySQL/servers"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "mysqlServer"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "MySQL-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForMySQL",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForMySQL",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7249119Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforpostgresql": {
            "properties": {
              "displayName": "Deploy DNS for PostgreSQL",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7562646Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1472597Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.DBforPostgreSQL/servers"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "postgresqlServer"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "PostgreSQL-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPostgreSQL",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForPostgreSQL",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6936592Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforpurviewaccount": {
            "properties": {
              "displayName": "Deploy DNS for Purview Account",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7501649Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.14189Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Purview/accounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "account"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "PurviewAccount-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPurviewAccount",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForPurviewAccount",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7092847Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforpurviewportal": {
            "properties": {
              "displayName": "Deploy DNS for Purview Portal",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7888435Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1452156Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Purview/accounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "portal"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "PurviewPortal-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPurviewPortal",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForPurviewPortal",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7405341Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforrelay": {
            "properties": {
              "displayName": "Deploy DNS for Relay",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7450514Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1249265Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Relay/namespaces"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "namespace"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "Relay-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForRelay",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForRelay",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7092847Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforservicebus": {
            "properties": {
              "displayName": "Deploy DNS for Service Bus",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.763275Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1479913Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.ServiceBus/namespaces"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "namespace"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "ServiceBus-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForServiceBus",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForServiceBus",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7092847Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforsignalr": {
            "properties": {
              "displayName": "Deploy DNS for SignalR",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7843895Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1421364Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.SignalRService/signalR"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "signalR"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "SignalR-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSignalR",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForSignalR",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7405341Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforsqlserver": {
            "properties": {
              "displayName": "Deploy DNS for Sql Server",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7432149Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1377328Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Sql/servers"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "sqlServer"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "SqlServer-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSqlServer",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForSqlServer",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6936592Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstorageblob": {
            "properties": {
              "displayName": "Deploy DNS for Storage Blob",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7218199Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1240457Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "blob"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageBlob-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageBlob",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageBlob",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstorageblobsecondary": {
            "properties": {
              "displayName": "Deploy DNS for Storage Blob Secondary",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7964936Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.133232Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "blob_secondary"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageBlobSecondary-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageBlobSecondary",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageBlobSecondary",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7561606Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0987515Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstoragefile": {
            "properties": {
              "displayName": "Deploy DNS for Storage File",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7503572Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1149869Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "file"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageFile-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageFile",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageFile",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6936592Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstoragequeue": {
            "properties": {
              "displayName": "Deploy DNS for Storage Queue",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7349778Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1467723Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "queue"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageQueue-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageQueue",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageQueue",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6936592Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstoragequeuesecondary": {
            "properties": {
              "displayName": "Deploy DNS for Storage Queue Secondary",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7115769Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1236439Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "queue_secondary"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageQueueSecondary-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageQueueSecondary",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageQueueSecondary",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstoragetable": {
            "properties": {
              "displayName": "Deploy DNS for Storage Table",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.8065508Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1124371Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "table"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageTable-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageTable",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageTable",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7717886Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstoragetablesecondary": {
            "properties": {
              "displayName": "Deploy DNS for Storage Table Secondary",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.8398606Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1457464Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "table_secondary"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageTableSecondary-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageTableSecondary",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageTableSecondary",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7717886Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstorageweb": {
            "properties": {
              "displayName": "Deploy DNS for Storage Web",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7213864Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1110743Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "web"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageWeb-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageWeb",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageWeb",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforstoragewebsecondary": {
            "properties": {
              "displayName": "Deploy DNS for Storage Web Secondary",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7991622Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.130841Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Storage/storageAccounts"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "web_secondary"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "StorageWebSecondary-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageWebSecondary",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForStorageWebSecondary",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7717886Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforsynapsedev": {
            "properties": {
              "displayName": "Deploy DNS for Synapse Dev",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7811834Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1166278Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Synapse/workspaces"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "dev"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "SynapseDev-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseDev",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForSynapseDev",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7249119Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforsynapsesql": {
            "properties": {
              "displayName": "Deploy DNS for Synapse Sql",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7250275Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:15.0118884Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Synapse/workspaces"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "sql"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "SynapseSql-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseSql",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForSynapseSql",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:15.0052532Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforsynapsesqlondemand": {
            "properties": {
              "displayName": "Deploy DNS for Synapse Sql On Demand",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7093429Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1265889Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Synapse/workspaces"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "sqlOnDemand"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "SynapseSqlOnDemand-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseSqlOnDemand",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForSynapseSqlOnDemand",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforsynapsestudio": {
            "properties": {
              "displayName": "Deploy DNS for Synapse Studio",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7189187Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1473494Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Synapse/workspaces"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "web"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "SynapseStudio-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseStudio",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForSynapseStudio",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.6780361Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0831266Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policydefinitions/deploydnsforwebapps": {
            "properties": {
              "displayName": "Deploy DNS for Web Apps",
              "policyType": "Custom",
              "mode": "All",
              "metadata": {
                "category": "Custom",
                "source": "Bicep",
                "version": "0.2.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:15.7494048Z",
                "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "updatedOn": "2022-12-28T11:50:12.1230253Z"
              },
              "parameters": {
                "privateDnsZoneId": {
                  "type": "String",
                  "metadata": {
                    "displayName": "privateDnsZoneId",
                    "strongType": "Microsoft.Network/privateDnsZones"
                  }
                }
              },
              "policyRule": {
                "if": {
                  "allOf": [
                    {
                      "field": "type",
                      "equals": "Microsoft.Network/privateEndpoints"
                    },
                    {
                      "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId",
                      "contains": "Microsoft.Web/sites"
                    },
                    {
                      "count": {
                        "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                        "where": {
                          "field": "Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]",
                          "equals": "sites"
                        }
                      },
                      "greaterOrEquals": 1
                    }
                  ]
                },
                "then": {
                  "effect": "deployIfNotExists",
                  "details": {
                    "roleDefinitionIds": [
                      "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
                    ],
                    "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                    "deployment": {
                      "properties": {
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "privateDnsZoneId": {
                              "type": "String"
                            },
                            "privateEndpointName": {
                              "type": "String"
                            },
                            "location": {
                              "type": "String"
                            }
                          },
                          "resources": [
                            {
                              "name": "[concat(parameters('privateEndpointName'), '/deployedByPolicy')]",
                              "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
                              "apiVersion": "2020-03-01",
                              "location": "westeurope",
                              "properties": {
                                "privateDnsZoneConfigs": [
                                  {
                                    "name": "WebApps-privateDnsZone",
                                    "properties": {
                                      "privateDnsZoneId": "[parameters('privateDnsZoneId')]"
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        },
                        "parameters": {
                          "privateDnsZoneId": {
                            "value": "[parameters('privateDnsZoneId')]"
                          },
                          "privateEndpointName": {
                            "value": "[field('name')]"
                          },
                          "location": {
                            "value": "[field('location')]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForWebApps",
            "type": "Microsoft.Authorization/policyDefinitions",
            "name": "DeployDNSForWebApps",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:15.7092847Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:12.0675007Z"
            }
          }
        },
        "PolicySetDefinitionsCustom": {
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policysetdefinitions/onetenant deploy private endpoint dns configurations": {
            "properties": {
              "displayName": "Onetenant Deploy Private Endpoint DNS Configurations",
              "policyType": "Custom",
              "metadata": {
                "category": "Custom",
                "version": "2.0.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:50:16.0798868Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "AutomationWebhook",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAutomationWebhook",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.azure-automation.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "AutomationDSCAndHybridWorker",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAutomationDSCAndHybridWorker",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.azure-automation.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SqlServer",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSqlServer",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.database.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SynapseSql",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseSql",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.sql.azuresynapse.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SynapseSqlOnDemand",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseSqlOnDemand",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.sql.azuresynapse.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SynapseDev",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseDev",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.dev.azuresynapse.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SynapseStudio",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseStudio",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.azuresynapse.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageBlob",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageBlob",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.blob.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageBlobSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageBlobSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.blob.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageTable",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageTable",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.table.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageTableSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageTableSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.table.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageQueue",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageQueue",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.queue.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageQueueSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageQueueSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.queue.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageFile",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageFile",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.file.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageWeb",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageWeb",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.web.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageWebSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageWebSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.web.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DataLakeFileSystem",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataLakeFileSystem",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.dfs.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DataLakeFileSystemSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataLakeFileSystemSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.dfs.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosSql",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosSql",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.documents.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosMongoDB",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosMongoDB",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.mongo.cosmos.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosCassandra",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosCassandra",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.cassandra.cosmos.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosGremlin",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosGremlin",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.gremlin.cosmos.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosTable",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosTable",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.table.cosmos.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPostgreSQL",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.postgres.database.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "MySQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForMySQL",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.mysql.database.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "MariaDB",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForMariaDB",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.mariadb.database.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "KeyVault",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForKeyVault",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.vaultcore.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "AzureSearch",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAzureSearch",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.search.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "ContainerRegistry",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForContainerRegistry",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.azurecr.io"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "AppConfiguration",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAppConfiguration",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.azconfig.io"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "EventHubs",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventHubs",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.servicebus.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "ServiceBus",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForServiceBus",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.servicebus.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "Relay",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForRelay",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.servicebus.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "EventGridTopic",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventGridTopic",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.eventgrid.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "EventGridDomain",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventGridDomain",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.eventgrid.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "WebApps",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForWebApps",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.azurewebsites.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SignalR",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSignalR",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.service.signalr.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CognitiveServices",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCognitiveServices",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.cognitiveservices.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "AzureFileSync",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAzureFileSync",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.afs.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DataFactory",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataFactory",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.datafactory.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CacheforRedis",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCacheforRedis",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.redis.cache.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CacheforRedisEnterprise",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCacheforRedisEnterprise",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.redisenterprise.cache.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "PurviewAccount",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPurviewAccount",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.purview.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "PurviewPortal",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPurviewPortal",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.purviewstudio.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DigitalTwins",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDigitalTwins",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.digitaltwins.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "HDInsights",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForHDInsights",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform3-dev-weu-001/providers/Microsoft.Network/privateDnsZones/onetenant.privatelink.azurehdinsight.net"
                    }
                  }
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policySetDefinitions/Onetenant Deploy Private Endpoint DNS Configurations",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Onetenant Deploy Private Endpoint DNS Configurations",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:50:15.3645884Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:50:15.3645884Z"
            }
          },
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/policysetdefinitions/platform 2 deploy private endpoint dns configurations": {
            "properties": {
              "displayName": "Platform 2 Deploy Private Endpoint DNS Configurations",
              "policyType": "Custom",
              "metadata": {
                "category": "Custom",
                "version": "2.0.0",
                "createdBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                "createdOn": "2022-12-28T11:49:17.4171405Z",
                "updatedBy": null,
                "updatedOn": null
              },
              "policyDefinitions": [
                {
                  "policyDefinitionReferenceId": "AutomationWebhook",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAutomationWebhook",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "AutomationDSCAndHybridWorker",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAutomationDSCAndHybridWorker",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SqlServer",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSqlServer",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SynapseSql",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseSql",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SynapseSqlOnDemand",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseSqlOnDemand",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SynapseDev",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseDev",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SynapseStudio",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSynapseStudio",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageBlob",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageBlob",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageBlobSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageBlobSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageTable",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageTable",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageTableSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageTableSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageQueue",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageQueue",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageQueueSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageQueueSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageFile",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageFile",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageWeb",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageWeb",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "StorageWebSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForStorageWebSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DataLakeFileSystem",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataLakeFileSystem",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DataLakeFileSystemSecondary",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataLakeFileSystemSecondary",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosSql",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosSql",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosMongoDB",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosMongoDB",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosCassandra",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosCassandra",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosGremlin",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosGremlin",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CosmosTable",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCosmosTable",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "PostgreSQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPostgreSQL",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "MySQL",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForMySQL",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "MariaDB",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForMariaDB",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "KeyVault",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForKeyVault",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "AzureSearch",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAzureSearch",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "ContainerRegistry",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForContainerRegistry",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "AppConfiguration",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAppConfiguration",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "EventHubs",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventHubs",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "ServiceBus",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForServiceBus",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "Relay",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForRelay",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "EventGridTopic",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventGridTopic",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "EventGridDomain",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForEventGridDomain",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "WebApps",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForWebApps",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "SignalR",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForSignalR",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CognitiveServices",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCognitiveServices",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "AzureFileSync",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForAzureFileSync",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DataFactory",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDataFactory",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CacheforRedis",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCacheforRedis",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "CacheforRedisEnterprise",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForCacheforRedisEnterprise",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "PurviewAccount",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPurviewAccount",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "PurviewPortal",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForPurviewPortal",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "DigitalTwins",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForDigitalTwins",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net"
                    }
                  }
                },
                {
                  "policyDefinitionReferenceId": "HDInsights",
                  "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policyDefinitions/DeployDNSForHDInsights",
                  "parameters": {
                    "privateDnsZoneId": {
                      "value": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/rg-platform2-dev-weu-001/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net"
                    }
                  }
                }
              ]
            },
            "id": "/providers/Microsoft.Management/managementGroups/es-root/providers/Microsoft.Authorization/policySetDefinitions/Platform 2 Deploy Private Endpoint DNS Configurations",
            "type": "Microsoft.Authorization/policySetDefinitions",
            "name": "Platform 2 Deploy Private Endpoint DNS Configurations",
            "systemData": {
              "createdBy": "ben.kooijman@redeploy.com",
              "createdByType": "User",
              "createdAt": "2022-12-28T11:49:16.7561833Z",
              "lastModifiedBy": "ben.kooijman@redeploy.com",
              "lastModifiedByType": "User",
              "lastModifiedAt": "2022-12-28T11:49:16.7561833Z"
            }
          }
        },
        "BlueprintDefinitions": {},
        "PolicyAssignments": {},
        "RoleAssignments": {
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/roleassignments/9d4207b6-39bc-4faf-8295-e7716d72bcdf": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/roleassignments/9d4207b6-39bc-4faf-8295-e7716d72bcdf",
              "Scope": "/providers/Microsoft.Management/managementGroups/es-root",
              "DisplayName": "umi-github-actions-2",
              "SignInName": null,
              "RoleDefinitionName": "Reader",
              "RoleDefinitionId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
              "ObjectId": "c34de424-d382-429c-9eed-c7b3fef22a12",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/roleassignments/bb19f5d7-99da-4053-8263-772b3ef327ea": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/roleassignments/bb19f5d7-99da-4053-8263-772b3ef327ea",
              "Scope": "/providers/Microsoft.Management/managementGroups/es-root",
              "DisplayName": "BenKooijmanRedeploy",
              "SignInName": "ben.kooijman_redeploy.com#EXT#@benkooijman.onmicrosoft.com",
              "RoleDefinitionName": "Owner",
              "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
              "ObjectId": "dc956bb7-e4b1-4577-8c23-d21beae05321",
              "ObjectType": "User",
              "PIM": "false"
            }
          ],
          "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/roleassignments/e03241b5-bda8-48c2-aca1-8c6a7fc8690d": [
            {
              "RoleAssignmentId": "/providers/microsoft.management/managementgroups/es-root/providers/microsoft.authorization/roleassignments/e03241b5-bda8-48c2-aca1-8c6a7fc8690d",
              "Scope": "/providers/Microsoft.Management/managementGroups/es-root",
              "DisplayName": "postman-benkooijman",
              "SignInName": null,
              "RoleDefinitionName": "Contributor",
              "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
              "ObjectId": "421cc84f-baf4-4339-bca7-cee590a372f2",
              "ObjectType": "ServicePrincipal",
              "PIM": "false"
            }
          ]
        },
        "DiagnosticSettings": {},
        "Subscriptions": {
          "d15e24d4-e2d6-426e-ad94-8789e6c09f7c": {
            "SubscriptionName": "Visual Studio Enterprise Subscription – MPN",
            "SubscriptionQuotaId": "MSDN_2014-09-01",
            "SubscriptionState": "Enabled",
            "SubscriptionTags": {},
            "PolicyDefinitionsCustom": {
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/policydefinitions/denystoragedeletioninprod": {
                "properties": {
                  "displayName": "Deny the deletion of storage accounts in production",
                  "policyType": "Custom",
                  "mode": "Indexed",
                  "description": "",
                  "metadata": {
                    "category": "General",
                    "createdBy": "5df7c533-ca40-429d-8f90-16357c4b564b",
                    "createdOn": "2022-12-08T15:10:31.2523785Z",
                    "updatedBy": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                    "updatedOn": "2022-12-08T15:51:11.3155701Z"
                  },
                  "parameters": {
                    "env": {
                      "type": "String",
                      "metadata": {
                        "description": "Value of the environment tag this policy should apply to.",
                        "displayName": "Environment",
                        "strongType": "environment"
                      }
                    }
                  },
                  "policyRule": {
                    "if": {
                      "allOf": [
                        {
                          "equals": "lock",
                          "field": "tags.lockstatus"
                        },
                        {
                          "equals": "Microsoft.Storage/storageAccounts",
                          "field": "type"
                        },
                        {
                          "equals": "[parameters('env')]",
                          "field": "tags.environment"
                        }
                      ]
                    },
                    "then": {
                      "details": {
                        "actionNames": [
                          "delete"
                        ],
                        "cascadeBehaviors": {
                          "resourceGroup": "deny"
                        }
                      },
                      "effect": "DenyAction"
                    }
                  }
                },
                "id": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/Microsoft.Authorization/policyDefinitions/DenyStorageDeletionInProd",
                "type": "Microsoft.Authorization/policyDefinitions",
                "name": "DenyStorageDeletionInProd",
                "systemData": {
                  "createdBy": "ben@kooijman.se",
                  "createdByType": "User",
                  "createdAt": "2022-12-08T15:10:31.0491692Z",
                  "lastModifiedBy": "ben.kooijman@redeploy.com",
                  "lastModifiedByType": "User",
                  "lastModifiedAt": "2022-12-08T15:51:11.1929412Z"
                }
              }
            },
            "PolicySetDefinitionsCustom": {},
            "BlueprintDefinitions": {},
            "PolicyAssignments": {
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn": {
                "properties": {
                  "displayName": "ASC Default (subscription: d15e24d4-e2d6-426e-ad94-8789e6c09f7c)",
                  "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
                  "scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "parameters": {},
                  "description": "This is the default set of policies monitored by Azure Security Center. It was automatically assigned as part of onboarding to Security Center. The default assignment contains only audit policies. For more information please visit https://aka.ms/ascpolicies",
                  "metadata": {
                    "assignedBy": "Security Center",
                    "excludedOutOfTheBoxStandards": [
                      "PCI DSS 3.2.1",
                      "ISO 27001",
                      "SOC TSP"
                    ],
                    "createdBy": "974c0d44-2ed5-4409-a3cb-c38741298f12",
                    "createdOn": "2022-08-14T20:46:25.5128549Z",
                    "updatedBy": null,
                    "updatedOn": null
                  },
                  "enforcementMode": "Default"
                },
                "id": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn",
                "type": "Microsoft.Authorization/policyAssignments",
                "name": "SecurityCenterBuiltIn",
                "systemData": {
                  "createdBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                  "createdByType": "Application",
                  "createdAt": "2022-08-14T20:46:24.9566067Z",
                  "lastModifiedBy": "8edd93e1-2103-40b4-bd70-6e34e586362d",
                  "lastModifiedByType": "Application",
                  "lastModifiedAt": "2022-08-14T20:46:24.9566067Z"
                }
              }
            },
            "RoleAssignments": {
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/0013975b-9ef7-493f-8baf-8982e5c9a9da": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/0013975b-9ef7-493f-8baf-8982e5c9a9da",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": null,
                  "SignInName": null,
                  "RoleDefinitionName": "User Access Administrator",
                  "RoleDefinitionId": "18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "ObjectId": "ebcdd815-53ea-441e-af4b-cba71d2dd097",
                  "ObjectType": "Unknown",
                  "PIM": "false"
                }
              ],
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/412efb5d-e5c7-4ab8-9e82-a6400a2cd2ee": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/412efb5d-e5c7-4ab8-9e82-a6400a2cd2ee",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": "techlunch-0929",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "6df2e2bd-8e9a-4098-aacb-def8bcf78ac0",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/481b3658-5a12-4a74-9bac-2c718ec302e9": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/481b3658-5a12-4a74-9bac-2c718ec302e9",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": null,
                  "SignInName": null,
                  "RoleDefinitionName": "Key Vault Crypto Service Encryption User",
                  "RoleDefinitionId": "e147488a-f6f5-4113-8e2d-b22465e65bf6",
                  "ObjectId": "e2ecb1ab-e95f-4c34-8b93-5282bbef0bcc",
                  "ObjectType": "Unknown",
                  "PIM": "false"
                }
              ],
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/50923f64-21af-412e-bb2b-23ffaa9d6150": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/50923f64-21af-412e-bb2b-23ffaa9d6150",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": null,
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "ebcdd815-53ea-441e-af4b-cba71d2dd097",
                  "ObjectType": "Unknown",
                  "PIM": "false"
                }
              ],
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/8a8caafb-a432-4079-8407-686d8cec47a7": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/8a8caafb-a432-4079-8407-686d8cec47a7",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": "umi-github-actions-2",
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "c34de424-d382-429c-9eed-c7b3fef22a12",
                  "ObjectType": "ServicePrincipal",
                  "PIM": "false"
                }
              ],
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/9becec92-e14f-4c9a-8d41-2f7ce98a6a57": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/9becec92-e14f-4c9a-8d41-2f7ce98a6a57",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": "BenKooijmanRedeploy",
                  "SignInName": "ben.kooijman_redeploy.com#EXT#@benkooijman.onmicrosoft.com",
                  "RoleDefinitionName": "Owner",
                  "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                  "ObjectId": "dc956bb7-e4b1-4577-8c23-d21beae05321",
                  "ObjectType": "User",
                  "PIM": "false"
                }
              ],
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/a278501b-d1fa-4ddf-b3d4-39dacf5ea133": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/a278501b-d1fa-4ddf-b3d4-39dacf5ea133",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": null,
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "a2a69850-4243-4763-85b2-eebb8e322f87",
                  "ObjectType": "Unknown",
                  "PIM": "false"
                }
              ],
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/b91d5b90-62ae-4628-a133-2286e36f43d3": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/b91d5b90-62ae-4628-a133-2286e36f43d3",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": null,
                  "SignInName": null,
                  "RoleDefinitionName": "Contributor",
                  "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "ObjectId": "b6efb16b-feb0-4cec-b332-0a29ca6d68a2",
                  "ObjectType": "Unknown",
                  "PIM": "false"
                }
              ],
              "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/beddc1b1-2713-4b50-9418-3ee7249d357f": [
                {
                  "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/providers/microsoft.authorization/roleassignments/beddc1b1-2713-4b50-9418-3ee7249d357f",
                  "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c",
                  "DisplayName": "Ben Kooijman",
                  "SignInName": "ben_kooijman.se#EXT#@benkooijman.onmicrosoft.com",
                  "RoleDefinitionName": "Owner",
                  "RoleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                  "ObjectId": "5df7c533-ca40-429d-8f90-16357c4b564b",
                  "ObjectType": "User",
                  "PIM": "false"
                }
              ]
            },
            "BlueprintAssignments": {},
            "DiagnosticSettings": {},
            "ResourceGroups": {
              "aks-storage-investigation": {
                "RoleAssignments": {
                  "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/03b12bb8-8844-5c8a-bdf3-4ce3dced6fed": [
                    {
                      "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/03b12bb8-8844-5c8a-bdf3-4ce3dced6fed",
                      "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation",
                      "DisplayName": null,
                      "SignInName": null,
                      "RoleDefinitionName": "Contributor",
                      "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                      "ObjectId": "4dd1bb9b-2080-45a5-a89d-aed72eae3783",
                      "ObjectType": "Unknown",
                      "PIM": "false"
                    }
                  ],
                  "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/2f6ba605-ed3c-4c94-942a-1d319de533b6": [
                    {
                      "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/2f6ba605-ed3c-4c94-942a-1d319de533b6",
                      "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/aks-storage-investigation",
                      "DisplayName": null,
                      "SignInName": null,
                      "RoleDefinitionName": "Contributor",
                      "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                      "ObjectId": "7b9b7916-f412-4647-a04a-0653060dcb96",
                      "ObjectType": "Unknown",
                      "PIM": "false"
                    }
                  ],
                  "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/5a8d47e3-9ee2-5564-ba63-98d14d1f05f1": [
                    {
                      "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/5a8d47e3-9ee2-5564-ba63-98d14d1f05f1",
                      "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation",
                      "DisplayName": "bvault-storage-test-euw-01",
                      "SignInName": null,
                      "RoleDefinitionName": "Data Operator for Managed Disks",
                      "RoleDefinitionId": "959f8984-c045-4866-89c7-12bf9737be2e",
                      "ObjectId": "6f13bd9e-2241-4962-8de7-de9ae5a0d163",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ],
                  "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/b66ceb5a-1697-4a27-84b5-4fbef32c7881": [
                    {
                      "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/b66ceb5a-1697-4a27-84b5-4fbef32c7881",
                      "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/aks-storage-investigation",
                      "DisplayName": "bvault-storage-test-euw-01",
                      "SignInName": null,
                      "RoleDefinitionName": "Disk Snapshot Contributor",
                      "RoleDefinitionId": "7efff54f-a5b4-42b5-a1c5-5411624893ce",
                      "ObjectId": "6f13bd9e-2241-4962-8de7-de9ae5a0d163",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ],
                  "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/ccfbb888-32ea-5e3a-affc-82fab58bff59": [
                    {
                      "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/ccfbb888-32ea-5e3a-affc-82fab58bff59",
                      "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation",
                      "DisplayName": null,
                      "SignInName": null,
                      "RoleDefinitionName": "Contributor",
                      "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                      "ObjectId": "4be6b257-8cd3-4caa-adc1-0275169f175f",
                      "ObjectType": "Unknown",
                      "PIM": "false"
                    }
                  ],
                  "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/d5f61585-dd16-4437-b3c2-e4878af264a5": [
                    {
                      "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/d5f61585-dd16-4437-b3c2-e4878af264a5",
                      "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/aks-storage-investigation",
                      "DisplayName": null,
                      "SignInName": null,
                      "RoleDefinitionName": "Contributor",
                      "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                      "ObjectId": "3127e624-8e0b-4d58-bf35-74652cfad1bc",
                      "ObjectType": "Unknown",
                      "PIM": "false"
                    }
                  ],
                  "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/dc0a2fb1-ce72-4a35-86b2-4258f33d503b": [
                    {
                      "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/dc0a2fb1-ce72-4a35-86b2-4258f33d503b",
                      "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/aks-storage-investigation",
                      "DisplayName": null,
                      "SignInName": null,
                      "RoleDefinitionName": "Contributor",
                      "RoleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c",
                      "ObjectId": "cc4731d2-ba50-4f02-9f85-16557dff819f",
                      "ObjectType": "Unknown",
                      "PIM": "false"
                    }
                  ],
                  "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/fa161113-9841-41bd-a24f-c0a1cd4ae953": [
                    {
                      "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/aks-storage-investigation/providers/microsoft.authorization/roleassignments/fa161113-9841-41bd-a24f-c0a1cd4ae953",
                      "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/aks-storage-investigation",
                      "DisplayName": "bvault-storage-test-euw-01",
                      "SignInName": null,
                      "RoleDefinitionName": "Disk Restore Operator",
                      "RoleDefinitionId": "b50d9833-a0cb-478e-945f-707fcc997c13",
                      "ObjectId": "6f13bd9e-2241-4962-8de7-de9ae5a0d163",
                      "ObjectType": "ServicePrincipal",
                      "PIM": "false"
                    }
                  ]
                }
              },
              "integration-test-rg": {
                "Resources": {
                  "microsoft.network-virtualnetworks_integration-test-vnet": {
                    "RoleAssignments": {
                      "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/integration-test-rg/providers/microsoft.network/virtualnetworks/integration-test-vnet/subnets/aks-snet-blue/providers/microsoft.authorization/roleassignments/125d6db9-c3b3-a047-9deb-1fa31367f4ef": [
                        {
                          "RoleAssignmentId": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourcegroups/integration-test-rg/providers/microsoft.network/virtualnetworks/integration-test-vnet/subnets/aks-snet-blue/providers/microsoft.authorization/roleassignments/125d6db9-c3b3-a047-9deb-1fa31367f4ef",
                          "Scope": "/subscriptions/d15e24d4-e2d6-426e-ad94-8789e6c09f7c/resourceGroups/integration-test-rg/providers/Microsoft.Network/virtualNetworks/integration-test-vnet/subnets/aks-snet-blue",
                          "DisplayName": null,
                          "SignInName": null,
                          "RoleDefinitionName": "Network Contributor",
                          "RoleDefinitionId": "4d97b98b-1d4f-4787-a291-c67834d212e7",
                          "ObjectId": "2a00364c-703c-4ead-b15e-462daf532625",
                          "ObjectType": "Unknown",
                          "PIM": "false"
                        }
                      ]
                    }
                  }
                }
              }
            }
          }
        },
        "ManagementGroups": {}
      }
    },
    "CustomRoleDefinitions": {}
  }
}
